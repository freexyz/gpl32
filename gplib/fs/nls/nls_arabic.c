#include "fsystem.h"

typedef struct{  unsigned short Unicode, Char; } UNI_ARABIC_TABLE;

//unicode to arabic convert table
UNI_ARABIC_TABLE const UniToArabicTab[] = 
{
    { 0xA0, 0xA0 },
    { 0xA2, 0xA2 },
    { 0xA3, 0xA3 },
    { 0xA4, 0xA4 },
    { 0xA5, 0xA5 },
    { 0xA6, 0xA6 },
    { 0xA7, 0xA7 },
    { 0xA8, 0xA8 },
    { 0xA9, 0xA9 },
    { 0xAB, 0xAB },
    { 0xAC, 0xAC },
    { 0xAD, 0xAD },
    { 0xAE, 0xAE },
    { 0xAF, 0xAF },
    { 0xB0, 0xB0 },
    { 0xB1, 0xB1 },
    { 0xB2, 0xB2 },
    { 0xB3, 0xB3 },
    { 0xB4, 0xB4 },
    { 0xB5, 0xB5 },
    { 0xB6, 0xB6 },
    { 0xB7, 0xB7 },
    { 0xB8, 0xB8 },
    { 0xB9, 0xB9 },
    { 0xBB, 0xBB },
    { 0xBC, 0xBC },
    { 0xBD, 0xBD },
    { 0xBE, 0xBE },
    { 0xC0, 0x41 },
    { 0xC2, 0x41 },
    { 0xC7, 0x43 },
    { 0xC8, 0x45 },
    { 0xC9, 0x45 },
    { 0xCA, 0x45 },
    { 0xCB, 0x45 },
    { 0xCE, 0x49 },
    { 0xCF, 0x49 },
    { 0xD4, 0x4F },
    { 0xD7, 0xD7 },
    { 0xD9, 0x55 },
    { 0xDB, 0x55 },
    { 0xDC, 0x55 },
    { 0xE0, 0xE0 },
    { 0xE2, 0xE2 },
    { 0xE7, 0xE7 },
    { 0xE8, 0xE8 },
    { 0xE9, 0xE9 },
    { 0xEA, 0xEA },
    { 0xEB, 0xEB },
    { 0xEE, 0xEE },
    { 0xEF, 0xEF },
    { 0xF4, 0xF4 },
    { 0xF7, 0xF7 },
    { 0xF9, 0xF9 },
    { 0xFB, 0xFB },
    { 0xFC, 0xFC },
    { 0x152, 0x8C },
    { 0x153, 0x9C },
    { 0x191, 0x46 },
    { 0x192, 0x83 },
    { 0x2C6, 0x88 },
    { 0x60C, 0xA1 },
    { 0x61B, 0xBA },
    { 0x61F, 0xBF },
    { 0x621, 0xC1 },
    { 0x622, 0xC2 },
    { 0x623, 0xC3 },
    { 0x624, 0xC4 },
    { 0x625, 0xC5 },
    { 0x626, 0xC6 },
    { 0x627, 0xC7 },
    { 0x628, 0xC8 },
    { 0x629, 0xC9 },
    { 0x62A, 0xCA },
    { 0x62B, 0xCB },
    { 0x62C, 0xCC },
    { 0x62D, 0xCD },
    { 0x62E, 0xCE },
    { 0x62F, 0xCF },
    { 0x630, 0xD0 },
    { 0x631, 0xD1 },
    { 0x632, 0xD2 },
    { 0x633, 0xD3 },
    { 0x634, 0xD4 },
    { 0x635, 0xD5 },
    { 0x636, 0xD6 },
    { 0x637, 0xD8 },
    { 0x638, 0xD9 },
    { 0x639, 0xDA },
    { 0x63A, 0xDB },
    { 0x640, 0xDC },
    { 0x641, 0xDD },
    { 0x642, 0xDE },
    { 0x643, 0xDF },
    { 0x644, 0xE1 },
    { 0x645, 0xE3 },
    { 0x646, 0xE4 },
    { 0x647, 0xE5 },
    { 0x648, 0xE6 },
    { 0x649, 0xEC },
    { 0x64A, 0xED },
    { 0x64B, 0xF0 },
    { 0x64C, 0xF1 },
    { 0x64D, 0xF2 },
    { 0x64E, 0xF3 },
    { 0x64F, 0xF5 },
    { 0x650, 0xF6 },
    { 0x651, 0xF8 },
    { 0x652, 0xFA },
    { 0x679, 0x8A },
    { 0x67E, 0x81 },
    { 0x686, 0x8D },
    { 0x688, 0x8F },
    { 0x691, 0x9A },
    { 0x698, 0x8E },
    { 0x6A9, 0x98 },
    { 0x6AF, 0x90 },
    { 0x6BA, 0x9F },
    { 0x6BE, 0xAA },
    { 0x6C1, 0xC0 },
    { 0x6CC, 0xED },
    { 0x6D2, 0xFF },
    { 0x200C, 0x9D },
    { 0x200D, 0x9E },
    { 0x200E, 0xFD },
    { 0x200F, 0xFE },
    { 0x2013, 0x96 },
    { 0x2014, 0x97 },
    { 0x2018, 0x91 },
    { 0x2019, 0x92 },
    { 0x201A, 0x82 },
    { 0x201C, 0x93 },
    { 0x201D, 0x94 },
    { 0x201E, 0x84 },
    { 0x2020, 0x86 },
    { 0x2021, 0x87 },
    { 0x2022, 0x95 },
    { 0x2026, 0x85 },
    { 0x2030, 0x89 },
    { 0x2039, 0x8B },
    { 0x203A, 0x9B },
    { 0x20AC, 0x80 },
    { 0x2122, 0x99 },
    { 0xFB56, 0x81 },
    { 0xFB57, 0x81 },
    { 0xFB58, 0x81 },
    { 0xFB59, 0x81 },
    { 0xFB66, 0x8A },
    { 0xFB67, 0x8A },
    { 0xFB68, 0x8A },
    { 0xFB69, 0x8A },
    { 0xFB7A, 0x8D },
    { 0xFB7B, 0x8D },
    { 0xFB7C, 0x8D },
    { 0xFB7D, 0x8D },
    { 0xFB88, 0x8F },
    { 0xFB89, 0x8F },
    { 0xFB8A, 0x8E },
    { 0xFB8B, 0x8E },
    { 0xFB8C, 0x9A },
    { 0xFB8D, 0x9A },
    { 0xFB8E, 0x98 },
    { 0xFB8F, 0x98 },
    { 0xFB90, 0x98 },
    { 0xFB91, 0x98 },
    { 0xFB92, 0x90 },
    { 0xFB93, 0x90 },
    { 0xFB94, 0x90 },
    { 0xFB95, 0x90 },
    { 0xFB9E, 0x9F },
    { 0xFB9F, 0x9F },
    { 0xFBA6, 0xC0 },
    { 0xFBA7, 0xC0 },
    { 0xFBA8, 0xC0 },
    { 0xFBA9, 0xC0 },
    { 0xFBAA, 0xAA },
    { 0xFBAB, 0xAA },
    { 0xFBAC, 0xAA },
    { 0xFBAD, 0xAA },
    { 0xFBAE, 0xFF },
    { 0xFBAF, 0xFF },
    { 0xFE70, 0xF0 },
    { 0xFE71, 0xF0 },
    { 0xFE72, 0xF1 },
    { 0xFE74, 0xF2 },
    { 0xFE76, 0xF3 },
    { 0xFE77, 0xF3 },
    { 0xFE78, 0xF5 },
    { 0xFE79, 0xF5 },
    { 0xFE7A, 0xF6 },
    { 0xFE7B, 0xF6 },
    { 0xFE7C, 0xF8 },
    { 0xFE7D, 0xF8 },
    { 0xFE7E, 0xFA },
    { 0xFE7F, 0xFA },
    { 0xFE80, 0xC1 },
    { 0xFE81, 0xC2 },
    { 0xFE82, 0xC2 },
    { 0xFE83, 0xC3 },
    { 0xFE84, 0xC3 },
    { 0xFE85, 0xC4 },
    { 0xFE86, 0xC4 },
    { 0xFE87, 0xC5 },
    { 0xFE88, 0xC5 },
    { 0xFE89, 0xC6 },
    { 0xFE8A, 0xC6 },
    { 0xFE8B, 0xC6 },
    { 0xFE8C, 0xC6 },
    { 0xFE8D, 0xC7 },
    { 0xFE8E, 0xC7 },
    { 0xFE8F, 0xC8 },
    { 0xFE90, 0xC8 },
    { 0xFE91, 0xC8 },
    { 0xFE92, 0xC8 },
    { 0xFE93, 0xC9 },
    { 0xFE94, 0xC9 },
    { 0xFE95, 0xCA },
    { 0xFE96, 0xCA },
    { 0xFE97, 0xCA },
    { 0xFE98, 0xCA },
    { 0xFE99, 0xCB },
    { 0xFE9A, 0xCB },
    { 0xFE9B, 0xCB },
    { 0xFE9C, 0xCB },
    { 0xFE9D, 0xCC },
    { 0xFE9E, 0xCC },
    { 0xFE9F, 0xCC },
    { 0xFEA0, 0xCC },
    { 0xFEA1, 0xCD },
    { 0xFEA2, 0xCD },
    { 0xFEA3, 0xCD },
    { 0xFEA4, 0xCD },
    { 0xFEA5, 0xCE },
    { 0xFEA6, 0xCE },
    { 0xFEA7, 0xCE },
    { 0xFEA8, 0xCE },
    { 0xFEA9, 0xCF },
    { 0xFEAA, 0xCF },
    { 0xFEAB, 0xD0 },
    { 0xFEAC, 0xD0 },
    { 0xFEAD, 0xD1 },
    { 0xFEAE, 0xD1 },
    { 0xFEAF, 0xD2 },
    { 0xFEB0, 0xD2 },
    { 0xFEB1, 0xD3 },
    { 0xFEB2, 0xD3 },
    { 0xFEB3, 0xD3 },
    { 0xFEB4, 0xD3 },
    { 0xFEB5, 0xD4 },
    { 0xFEB6, 0xD4 },
    { 0xFEB7, 0xD4 },
    { 0xFEB8, 0xD4 },
    { 0xFEB9, 0xD5 },
    { 0xFEBA, 0xD5 },
    { 0xFEBB, 0xD5 },
    { 0xFEBC, 0xD5 },
    { 0xFEBD, 0xD6 },
    { 0xFEBE, 0xD6 },
    { 0xFEBF, 0xD6 },
    { 0xFEC0, 0xD6 },
    { 0xFEC1, 0xD8 },
    { 0xFEC2, 0xD8 },
    { 0xFEC3, 0xD8 },
    { 0xFEC4, 0xD8 },
    { 0xFEC5, 0xD9 },
    { 0xFEC6, 0xD9 },
    { 0xFEC7, 0xD9 },
    { 0xFEC8, 0xD9 },
    { 0xFEC9, 0xDA },
    { 0xFECA, 0xDA },
    { 0xFECB, 0xDA },
    { 0xFECC, 0xDA },
    { 0xFECD, 0xDB },
    { 0xFECE, 0xDB },
    { 0xFECF, 0xDB },
    { 0xFED0, 0xDB },
    { 0xFED1, 0xDD },
    { 0xFED2, 0xDD },
    { 0xFED3, 0xDD },
    { 0xFED4, 0xDD },
    { 0xFED5, 0xDE },
    { 0xFED6, 0xDE },
    { 0xFED7, 0xDE },
    { 0xFED8, 0xDE },
    { 0xFED9, 0xDF },
    { 0xFEDA, 0xDF },
    { 0xFEDB, 0xDF },
    { 0xFEDC, 0xDF },
    { 0xFEDD, 0xE1 },
    { 0xFEDE, 0xE1 },
    { 0xFEDF, 0xE1 },
    { 0xFEE0, 0xE1 },
    { 0xFEE1, 0xE3 },
    { 0xFEE2, 0xE3 },
    { 0xFEE3, 0xE3 },
    { 0xFEE4, 0xE3 },
    { 0xFEE5, 0xE4 },
    { 0xFEE6, 0xE4 },
    { 0xFEE7, 0xE4 },
    { 0xFEE8, 0xE4 },
    { 0xFEE9, 0xE5 },
    { 0xFEEA, 0xE5 },
    { 0xFEEB, 0xE5 },
    { 0xFEEC, 0xE5 },
    { 0xFEED, 0xE6 },
    { 0xFEEE, 0xE6 },
    { 0xFEEF, 0xEC },
    { 0xFEF0, 0xEC },
    { 0xFEF1, 0xED },
    { 0xFEF2, 0xED },
    { 0xFEF3, 0xED },
    { 0xFEF4, 0xED },
    { 0xFF01, 0x21 },
    { 0xFF02, 0x22 },
    { 0xFF03, 0x23 },
    { 0xFF04, 0x24 },
    { 0xFF05, 0x25 },
    { 0xFF06, 0x26 },
    { 0xFF07, 0x27 },
    { 0xFF08, 0x28 },
    { 0xFF09, 0x29 },
    { 0xFF0A, 0x2A },
    { 0xFF0B, 0x2B },
    { 0xFF0C, 0x2C },
    { 0xFF0D, 0x2D },
    { 0xFF0E, 0x2E },
    { 0xFF0F, 0x2F },
    { 0xFF10, 0x30 },
    { 0xFF11, 0x31 },
    { 0xFF12, 0x32 },
    { 0xFF13, 0x33 },
    { 0xFF14, 0x34 },
    { 0xFF15, 0x35 },
    { 0xFF16, 0x36 },
    { 0xFF17, 0x37 },
    { 0xFF18, 0x38 },
    { 0xFF19, 0x39 },
    { 0xFF1A, 0x3A },
    { 0xFF1B, 0x3B },
    { 0xFF1C, 0x3C },
    { 0xFF1D, 0x3D },
    { 0xFF1E, 0x3E },
    { 0xFF20, 0x40 },
    { 0xFF21, 0x41 },
    { 0xFF22, 0x42 },
    { 0xFF23, 0x43 },
    { 0xFF24, 0x44 },
    { 0xFF25, 0x45 },
    { 0xFF26, 0x46 },
    { 0xFF27, 0x47 },
    { 0xFF28, 0x48 },
    { 0xFF29, 0x49 },
    { 0xFF2A, 0x4A },
    { 0xFF2B, 0x4B },
    { 0xFF2C, 0x4C },
    { 0xFF2D, 0x4D },
    { 0xFF2E, 0x4E },
    { 0xFF2F, 0x4F },
    { 0xFF30, 0x50 },
    { 0xFF31, 0x51 },
    { 0xFF32, 0x52 },
    { 0xFF33, 0x53 },
    { 0xFF34, 0x54 },
    { 0xFF35, 0x55 },
    { 0xFF36, 0x56 },
    { 0xFF37, 0x57 },
    { 0xFF38, 0x58 },
    { 0xFF39, 0x59 },
    { 0xFF3A, 0x5A },
    { 0xFF3B, 0x5B },
    { 0xFF3C, 0x5C },
    { 0xFF3D, 0x5D },
    { 0xFF3E, 0x5E },
    { 0xFF3F, 0x5F },
    { 0xFF40, 0x60 },
    { 0xFF41, 0x61 },
    { 0xFF42, 0x62 },
    { 0xFF43, 0x63 },
    { 0xFF44, 0x64 },
    { 0xFF45, 0x65 },
    { 0xFF46, 0x66 },
    { 0xFF47, 0x67 },
    { 0xFF48, 0x68 },
    { 0xFF49, 0x69 },
    { 0xFF4A, 0x6A },
    { 0xFF4B, 0x6B },
    { 0xFF4C, 0x6C },
    { 0xFF4D, 0x6D },
    { 0xFF4E, 0x6E },
    { 0xFF4F, 0x6F },
    { 0xFF50, 0x70 },
    { 0xFF51, 0x71 },
    { 0xFF52, 0x72 },
    { 0xFF53, 0x73 },
    { 0xFF54, 0x74 },
    { 0xFF55, 0x75 },
    { 0xFF56, 0x76 },
    { 0xFF57, 0x77 },
    { 0xFF58, 0x78 },
    { 0xFF59, 0x79 },
    { 0xFF5A, 0x7A },
    { 0xFF5B, 0x7B },
    { 0xFF5C, 0x7C },
    { 0xFF5D, 0x7D },
    { 0xFF5E, 0x7E }
};

//arabic to unicode convert table
//the table area is 0x80~0xff
const unsigned int ArabicToUniTab[] = 
{
    0x20AC	,
    0x67E	,
    0x201A	,
    0x192	,
    0x201E	,
    0x2026	,
    0x2020	,
    0x2021	,
    0x2C6	,
    0x2030	,
    0x679	,
    0x2039	,
    0x152	,
    0x686	,
    0x698	,
    0x688	,
    0x6AF	,
    0x2018	,
    0x2019	,
    0x201C	,
    0x201D	,
    0x2022	,
    0x2013	,
    0x2014	,
    0x6A9	,
    0x2122	,
    0x691	,
    0x203A	,
    0x153	,
    0x200C	,
    0x200D	,
    0x6BA	,
    0xA0	,
    0x60C	,
    0xA2	,
    0xA3	,
    0xA4	,
    0xA5	,
    0xA6	,
    0xA7	,
    0xA8	,
    0xA9	,
    0x6BE	,
    0xAB	,
    0xAC	,
    0xAD	,
    0xAE	,
    0xAF	,
    0xB0	,
    0xB1	,
    0xB2	,
    0xB3	,
    0xB4	,
    0xB5	,
    0xB6	,
    0xB7	,
    0xB8	,
    0xB9	,
    0x61B	,
    0xBB	,
    0xBC	,
    0xBD	,
    0xBE	,
    0x61F	,
    0x6C1	,
    0x621	,
    0x622	,
    0x623	,
    0x624	,
    0x625	,
    0x626	,
    0x627	,
    0x628	,
    0x629	,
    0x62A	,
    0x62B	,
    0x62C	,
    0x62D	,
    0x62E	,
    0x62F	,
    0x630	,
    0x631	,
    0x632	,
    0x633	,
    0x634	,
    0x635	,
    0x636	,
    0xD7	,
    0x637	,
    0x638	,
    0x639	,
    0x63A	,
    0x640	,
    0x641	,
    0x642	,
    0x643	,
    0xE0	,
    0x644	,
    0xE2	,
    0x645	,
    0x646	,
    0x647	,
    0x648	,
    0xE7	,
    0xE8	,
    0xE9	,
    0xEA	,
    0xEB	,
    0x649	,
    0x64A	,
    0xEE	,
    0xEF	,
    0x64B	,
    0x64C	,
    0x64D	,
    0x64E	,
    0xF4	,
    0x64F	,
    0x650	,
    0xF7	,
    0x651	,
    0xF9	,
    0x652	,
    0xFB	,
    0xFC	,
    0x200E	,
    0x200F	,
    0x6D2
};

// init arabic unitab
static short  arabic_init_nls(void)
{
	return 0;
}

// exit arabic unitab
static short arabic_exit_nls(void)
{
	return 0;
}

// returns the arabic character from unicode
// return 0 is error
static unsigned short arabic_uni2char(unsigned short unicode)
{
	if ((unicode < 0x00a0) || (unicode > 0xFF5E)) 
	{
		return 0;           //error 
	}
	else 
	{
		unsigned int Semi, Lo = 0, Hi = 405-1;
		
		for (;;)
		{
			if (UniToArabicTab[Lo].Unicode > unicode) 
				break;
			if (UniToArabicTab[Lo].Unicode == unicode) 
				return UniToArabicTab[Lo].Char;
			if (UniToArabicTab[Hi].Unicode < unicode) 
				break;
			if (UniToArabicTab[Hi].Unicode == unicode) 
				return UniToArabicTab[Hi].Char;
			
			Semi = (Lo + Hi) >> 1;
			if (UniToArabicTab[Semi].Unicode == unicode) 
				return UniToArabicTab[Semi].Char;
			if (Hi - Lo == 0) 
				break;
			if (UniToArabicTab[Semi].Unicode < unicode) 
				Lo = Semi+1;
			else 
				Hi = Semi-1;
		}
	}
	return 0;               //error
}

// returns the unicode from arabic character
// return 0 is error
static unsigned short arabic_char2uni(unsigned char **rawstring)
{
	unsigned char *temp = *rawstring;
	
	*rawstring += 1;        //the point add 1
#ifdef unSP
	if (*temp > 0xff)	
		return 0;			//error
	else 
#endif
	if (*temp < 0x80) 
		return *temp;
	else 
		return ArabicToUniTab[*temp - 0x80];
}

const struct nls_table nls_arabic_table = {
	"arabic",
	0, 
	arabic_init_nls,
	arabic_exit_nls,
	arabic_uni2char,
	arabic_char2uni,
};
